id: CVE-2025-61675

info:
  name: FreePBX Authenticated SQL Injection - CVE-2025-61675
  author: rxerium
  severity: high
  description: |
    Authenticated SQL injection vulnerabilities in FreePBX affecting four unique endpoints (basestation, model, firmware, and custom extension)
    with 11 affected parameters that enable read and write access to the underlying SQL database.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2025-61675
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:N
    cvss-score: 8.6
    cve-id: CVE-2025-61675
  metadata:
    verified: true
    max-request: 1
    shodan-query:
      - http.title:"FreePBX Administration"
  tags: freepbx,sqli,authenticated,sangoma,zeroday

http:
  - method: GET
    path:
      - '{{BaseURL}}/admin/config.php#'

    extractors:
      - type: regex
        part: body
        name: version
        regex:
          - 'FreePBX\s+([0-9]+\.[0-9]+\.[0-9]+\.[0-9]+)'
        group: 1

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - 'FreePBX Administration'
          - 'Operator Panel'
          - 'User Control Panel'
        condition: and

      - type: status
        status:
          - 200

      - type: dsl
        dsl:
          - compare_versions(version, ">= 16.0.0.0", "< 16.0.92.0") || compare_versions(version, ">= 17.0.0.0", "< 17.0.6.0")
